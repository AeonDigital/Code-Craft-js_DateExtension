Date.DayOfWeek={Sunday:'Sunday',Monday:'Monday',Tuesday:'Tuesday',Wednesday:'Wednesday',Thursday:'Thursday',Friday:'Friday',Saturday:'Saturday'};Date.IsLeapYear=function(y){if(y%4==0&&(y%100!=0||y%400==0)){return true}return false};Date.DaysInMonth=function(y,m){var oD=new Date(y,(m+1),1);oD.setDate(oD.getDate()-1);return oD.getDate()};Date.DifferenceInDays=function(d1,d2){return Math.round(Math.abs(d1-d2)/86400000)};Date.Limit={Year:function(y){y=(y>9999)?9999:y;return(y<1)?1:y},Month:function(m){m=(m>11)?11:m;return(m<0)?0:m},Day:function(d,m,y){var mD=Date.DaysInMonth(y,m);d=(d>mD)?mD:d;return(d<1)?1:d},Hour:function(h){h=(h>23)?23:h;return(h<0)?0:h},Minute:function(m){m=(m>59)?59:m;return(m<0)?0:m},Second:function(s){s=(s>59)?59:s;return(s<0)?0:s},Millisecond:function(m){m=(m>999)?999:m;return(m<0)?0:m}};Date.prototype.Clone=function(){return new Date(this.getTime())};Date.prototype.DayOfWeek=function(){var dW=Date.DayOfWeek;var r=null;switch(this.getDay()){case 0:r=dW.Sunday;break;case 1:r=dW.Monday;break;case 2:r=dW.Tuesday;break;case 3:r=dW.Wednesday;break;case 4:r=dW.Thursday;break;case 5:r=dW.Friday;break;case 6:r=dW.Saturday;break}return r};Date.prototype.SetYear=function(y){var o=this.Clone();o.setFullYear(Date.Limit.Year(y));return o};Date.prototype.AddYears=function(y){var o=this.Clone();o.setFullYear(o.getFullYear()+y);return o};Date.prototype.SetMonth=function(m){var o=this.Clone();o.setMonth(Date.Limit.Month(m));return o};Date.prototype.AddMonths=function(m){var o=this.Clone();o.setMonth(this.getMonth()+m);return o};Date.prototype.SetDay=function(d){var o=this.Clone();o.setDate(Date.Limit.Day(d,o.getMonth(),o.getFullYear()));return o};Date.prototype.AddDays=function(d){var o=this.Clone();o.setDate(this.getDate()+d);return o};Date.prototype.SetHour=function(h){var o=this.Clone();o.setHours(Date.Limit.Hour(h));return o};Date.prototype.AddHours=function(h){var o=this.Clone();o.setHours(this.getHours()+h);return o};Date.prototype.SetMinute=function(m){var o=this.Clone();o.setMinutes(Date.Limit.Minute(m));return o};Date.prototype.AddMinutes=function(m){var o=this.Clone();o.setMinutes(this.getMinutes()+m);return o};Date.prototype.SetSecond=function(s){var o=this.Clone();o.setSeconds(Date.Limit.Second(s));return o};Date.prototype.AddSeconds=function(s){var o=this.Clone();o.setSeconds(this.getSeconds()+s);return o};Date.prototype.SetMillisecond=function(m){var o=this.Clone();o.setMilliseconds(Date.Limit.Millisecond(m));return o};Date.prototype.AddMilliseconds=function(n){var o=this.Clone();o.setMilliseconds(this.getMilliseconds()+n);return o};Date.prototype.SetDate=function(y,m,d){y=Date.Limit.Year(y);m=Date.Limit.Month(m);d=Date.Limit.Day(d,y,m);return new Date(y,m,d,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.SetTime=function(h,m,s,ml){var dL=Date.Limit;h=dL.Hour(h);m=dL.Minute(m);s=dL.Second(s);ml=(ml===undefined)?this.getMilliseconds():dL.Millisecond(ml);return new Date(this.getFullYear(),this.getMonth(),this.getDate(),h,m,s,ml)};Date.prototype.FirstWorkDayInMonth=function(){var o=this.Clone();o=o.SetDay(1);return(o.getDay()==0)?o.AddDays(1):((o.getDay()==6)?o.AddDays(2):o)};Date.prototype.FirstDayOfWeekInMonth=function(d){var o=this.Clone();o=o.SetDay(1);d=(d==0)?7:d;var bD=(o.getDay()==0)?7:o.getDay();return o.AddDays((d>=bD)?d-bD:7-bD+d)};Date.prototype.FirstWorkDayInYear=function(){var o=this.Clone();return o.SetMonth(0).FirstWorkDayInMonth()};Date.prototype.FirstDayOfWeekInYear=function(d){var o=this.Clone();return o.SetMonth(0).FirstDayOfWeekInMonth(d)};Date.prototype.LastWorkDayInMonth=function(){var o=this.Clone();o=o.SetDay(Date.DaysInMonth(o.getFullYear(),o.getMonth()));return o.AddDays((o.getDay()==0)?-2:((o.getDay()==6)?-1:0))};Date.prototype.LastDayOfWeekInMonth=function(d){var o=this.Clone();o=o.SetDay(Date.DaysInMonth(o.getFullYear(),o.getMonth()));d=(d==0)?7:d;var bD=(o.getDay()==0)?7:o.getDay();return o.AddDays(((bD>=d)?(bD-d)*-1:(7+bD-d)*-1))};Date.prototype.LastWorkDayInYear=function(){var o=this.Clone();o=o.SetMonth(11);return o.LastWorkDayInMonth()};Date.prototype.LastDayOfWeekInYear=function(d){var o=this.Clone();o=o.SetMonth(11);return o.LastDayOfWeekInMonth(d)};Date.prototype.ClosestWorkDay=function(){var o=this.Clone();var bD=o.getDay();return((bD==6)?o.AddDays(-1):((bD==0)?o.AddDays(1):o))};Date.prototype.NextWorkDay=function(){var o=this.Clone();var bD=o.getDay();return((bD==6)?o.AddDays(2):((bD==0)?o.AddDays(1):o))};Date.prototype.IsHoliday_Brasil=function(){var m=this.getMonth();var d=this.getDate();if((m==0&&d==1)||(m==3&&d==21)||(m==4&&d==1)||(m==8&&d==7)||(m==9&&d==12)||(m==10&&d==2)||(m==10&&d==15)||(m==11&&d==25)){return true}return false};Date.prototype.NextWorkDay_Brasil=function(){var o=this.Clone();while(o.DayOfWeek()==Date.DayOfWeek.Saturday||o.DayOfWeek()==Date.DayOfWeek.Sunday||o.IsHoliday_Brasil()){o=o.AddDays(1)}return o};Date.prototype.BeginningOfDay=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0,0)};Date.prototype.BeginningOfWeek=function(){var o=this.Clone();while(o.getDay()!=1){o.setDate(o.getDate()-1)}return o};Date.prototype.BeginningOfMonth=function(){return new Date(this.getFullYear(),this.getMonth(),1,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.BeginningOfYear=function(){return new Date(this.getFullYear(),0,1,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.EndOfDay=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate(),23,59,59,999)};Date.prototype.EndOfMonth=function(){return new Date(this.getFullYear(),this.getMonth(),Date.DaysInMonth(this.getFullYear(),this.getMonth()),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.EndOfYear=function(){return new Date(this.getFullYear(),11,31,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};